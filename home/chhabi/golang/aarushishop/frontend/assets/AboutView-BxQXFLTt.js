import{_ as I,m as O,u as x,r as p,e as U,d as A,c as v,a as e,w as i,v as n,F as L,i as j,h as T,l as D,o as m,t as y,p as E,b as F}from"./index-DTfqHd0M.js";import{u as B}from"./categories-BvQckuKW.js";const r=u=>(E("data-v-0ac0671b"),u=u(),F(),u),$={class:"purchase-entry-form"},N=r(()=>e("h2",null,"Data Entry Form",-1)),z={class:"form-group"},M=r(()=>e("label",{for:"po"},"PO:",-1)),G={class:"form-group"},J=r(()=>e("label",{for:"Pdate"},"Date:",-1)),Q={class:"form-group"},H=r(()=>e("label",{for:"itemList"},"Item List:",-1)),K={class:"autocomplete"},R={key:0,class:"item-list"},W=["onClick"],X={class:"form-group"},Y=r(()=>e("label",{for:"vendor"},"Supplier:",-1)),Z={class:"form-group"},ee=r(()=>e("label",{for:"description"},"Description:",-1)),te={class:"form-group"},oe=r(()=>e("label",{for:"qty"},"Qty:",-1)),se={class:"form-group"},ae=r(()=>e("label",{for:"unit"},"Unit:",-1)),re={class:"form-group"},ie=r(()=>e("label",{for:"category"},"Category:",-1)),ne={class:"form-group"},le=r(()=>e("label",{for:"price"},"Price:",-1)),ue=r(()=>e("button",{type:"submit"},"Save",-1)),de=r(()=>e("button",{type:"cancel"},"Cancel",-1)),ce={__name:"AboutView",setup(u){const{notify:d}=O(),g=B(),h=x(),{categories:b,fetchCategories:P}=g,f=p([]),c=p(""),l=p(!1),w=async()=>{try{const a=await fetch("http://localhost:8000/api/inventory/itemlist",{method:"GET",headers:{Accept:"application/json",Authorization:h.token},credentials:"include"});if(a.ok){const t=await a.json();f.value=t.data}else d("Failed to fetch item lists from server","error")}catch(a){console.error("Error fetching items:",a)}};U(()=>{b.length===0&&P(),w();const a=new Date().toISOString().substr(0,10);s.value.Pdate=a});const s=p({PO:0,Pdate:"",vendor:"Chhesko Pvt. Ltd.",item_list:"",description:"",qty:0,unit:"",category:"",price:0}),S=()=>{l.value=!0},q=()=>{setTimeout(()=>{l.value=!1},200)},k=a=>{s.value.item_list=a.item_list,s.value.description=a.description,s.value.category=a.category,s.value.unit=a.unit,c.value=`${a.item_list} - ${a.description}`,l.value=!1},V=A(()=>{const a=c.value.toLowerCase();return f.value.filter(t=>t.item_list.toLowerCase().includes(a)||t.description.toLowerCase().includes(a))}),C=async()=>{try{if(s.value.PO<=2){const o=await fetch(`http://localhost:8000/api/purchase/newpo?Pdate=${s.value.Pdate}`,{method:"GET",headers:{Accept:"application/json",Authorization:h.token},credentials:"include"});if(!o.ok){d("Failed to get PO number from server","error");return}let _=await o.json();console.log(_),s.value.PO=_.newPO}const a=await fetch("http://localhost:8000/api/purchase/save",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:h.token},credentials:"include",body:JSON.stringify(s.value)}),t=await a.json();a.ok?d(t.message,"success"):d(t.message,"error")}catch(a){console.error("Error saving purchase record:",a)}};return(a,t)=>(m(),v("div",$,[N,e("form",{onSubmit:D(C,["prevent"])},[e("div",z,[M,i(e("input",{id:"po","onUpdate:modelValue":t[0]||(t[0]=o=>s.value.PO=o),type:"number",required:""},null,512),[[n,s.value.PO]])]),e("div",G,[J,i(e("input",{id:"Pdate","onUpdate:modelValue":t[1]||(t[1]=o=>s.value.Pdate=o),type:"date",required:""},null,512),[[n,s.value.Pdate]])]),e("div",Q,[H,e("div",K,[i(e("input",{id:"itemList","onUpdate:modelValue":t[2]||(t[2]=o=>c.value=o),type:"text",onInput:S,onFocus:t[3]||(t[3]=o=>l.value=!0),onBlur:q,placeholder:"Search or select an item",required:""},null,544),[[n,c.value]]),l.value?(m(),v("ul",R,[(m(!0),v(L,null,j(V.value,o=>(m(),v("li",{key:o.item_list,onClick:_=>k(o)}," [ "+y(o.item_list)+" ] "+y(o.description),9,W))),128))])):T("",!0)])]),e("div",X,[Y,i(e("input",{id:"vendor","onUpdate:modelValue":t[4]||(t[4]=o=>s.value.vendor=o),type:"text",required:""},null,512),[[n,s.value.vendor]])]),e("div",Z,[ee,i(e("textarea",{id:"description","onUpdate:modelValue":t[5]||(t[5]=o=>s.value.description=o),readonly:"",required:""},null,512),[[n,s.value.description]])]),e("div",te,[oe,i(e("input",{id:"qty","onUpdate:modelValue":t[6]||(t[6]=o=>s.value.qty=o),type:"number",required:""},null,512),[[n,s.value.qty]])]),e("div",se,[ae,i(e("input",{id:"unit","onUpdate:modelValue":t[7]||(t[7]=o=>s.value.unit=o),type:"text",readonly:"",required:""},null,512),[[n,s.value.unit]])]),e("div",re,[ie,i(e("input",{id:"category","onUpdate:modelValue":t[8]||(t[8]=o=>s.value.category=o),type:"text",readonly:"",required:""},null,512),[[n,s.value.category]])]),e("div",ne,[le,i(e("input",{id:"price","onUpdate:modelValue":t[9]||(t[9]=o=>s.value.price=o),type:"number",required:""},null,512),[[n,s.value.price]])]),ue,de],32)]))}},me=I(ce,[["__scopeId","data-v-0ac0671b"]]);export{me as default};
