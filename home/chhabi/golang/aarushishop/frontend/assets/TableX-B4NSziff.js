import{P as m}from"./PaginatioN-DQsouuFu.js";import{_,u as P,o as i,c as l,a as t,w as b,v as f,g as c,t as a,h as d,F as w,i as C,f as B,k as y,p as D,b as k,j as F}from"./index-DTfqHd0M.js";const v={components:{Pagination:m},data(){return{data:null,currentPage:1,totalPageCount:1,limit:20,totalRecords:0,sortByField:"PO",sortDirection:"asc",searchQuery:"",authstore:P()}},computed:{filteredData(){return this.data?this.searchQuery?this.data.filter(o=>Object.values(o).some(e=>String(e).toLowerCase().includes(this.searchQuery.toLowerCase()))):this.data:null},sortedData(){if(!this.filteredData)return null;let o=this.filteredData.slice();return this.sortByField&&o.sort((e,h)=>{let u=this.sortDirection==="desc"?-1:1;return e[this.sortByField]<h[this.sortByField]?-1*u:e[this.sortByField]>h[this.sortByField]?1*u:0}),o}},mounted(){this.fetchData()},methods:{async fetchData(){try{const e=await(await fetch(`http://localhost:8000/api/purchase/list?page=${this.currentPage}&limit=${this.limit}&search=${this.searchQuery}&sortBy=${this.sortByField}&sortOrder=${this.sortDirection}`,{method:"GET",headers:{"Content-Type":"application/json",authorization:this.authstore.token},credentials:"include"})).json();this.data=e.data,this.totalRecords=e.TotalRecords,this.totalPageCount=Math.ceil(e.TotalRecords/this.limit)}catch(o){console.error("Error fetching data:",o)}},handlePageChange(o){this.currentPage=o,this.fetchData()},handlePerPageChange(o){this.limit=o,this.currentPage=1,this.fetchData()},handleSearchChange(){this.currentPage=1,this.fetchData()},sortBy(o){this.sortByField=o,this.sortDirection=this.sortDirection==="asc"?"desc":"asc",this.fetchData()}}},g=o=>(D("data-v-9b7bb8b6"),o=o(),k(),o),T={class:"searcharea"},S={class:"Table"},O={key:0},x={class:"material-symbols-outlined"},Q={key:0},R={class:"material-symbols-outlined"},I={key:0},V={class:"material-symbols-outlined"},j={key:0},L={class:"material-symbols-outlined"},N={key:0},q={class:"material-symbols-outlined"},E={key:0},A={class:"material-symbols-outlined"},M={key:0},U={class:"material-symbols-outlined"},z={key:0},G={class:"material-symbols-outlined"},X=g(()=>t("th",null,"Actions",-1)),H=g(()=>t("td",null,[t("a",{href:"#"},"Details")],-1));function J(o,e,h,u,s,n){const p=y("Pagination");return i(),l("div",null,[t("div",T,[b(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=r=>s.searchQuery=r),placeholder:"Search...",onInput:e[1]||(e[1]=(...r)=>n.handleSearchChange&&n.handleSearchChange(...r))},null,544),[[f,s.searchQuery]])]),t("table",S,[t("thead",null,[t("tr",null,[t("th",{onClick:e[2]||(e[2]=r=>n.sortBy("PO")),class:"sortable"},[c(" PO "),s.sortByField==="PO"?(i(),l("span",O,[t("span",x,a(s.sortDirection==="asc"?"arrow_drop_up":"arrow_drop_down"),1)])):d("",!0)]),t("th",{onClick:e[3]||(e[3]=r=>n.sortBy("Pdate")),class:"sortable"},[c(" Date "),s.sortByField==="Pdate"?(i(),l("span",Q,[t("span",R,a(s.sortDirection==="asc"?"arrow_drop_up":"arrow_drop_down"),1)])):d("",!0)]),t("th",{onClick:e[4]||(e[4]=r=>n.sortBy("item_list")),class:"sortable"},[c(" Item List"),s.sortByField==="item_list"?(i(),l("span",I,[t("span",V,a(s.sortDirection==="asc"?"arrow_drop_up":"arrow_drop_down"),1)])):d("",!0)]),t("th",{onClick:e[5]||(e[5]=r=>n.sortBy("description")),class:"sortable"},[c(" Description"),s.sortByField==="description"?(i(),l("span",j,[t("span",L,a(s.sortDirection==="asc"?"arrow_drop_up":"arrow_drop_down"),1)])):d("",!0)]),t("th",{onClick:e[6]||(e[6]=r=>n.sortBy("category")),class:"sortable"},[c(" Category"),s.sortByField==="category"?(i(),l("span",N,[t("span",q,a(s.sortDirection==="asc"?"arrow_drop_up":"arrow_drop_down"),1)])):d("",!0)]),t("th",{onClick:e[7]||(e[7]=r=>n.sortBy("qty")),class:"sortable"},[c(" Qty"),s.sortByField==="qty"?(i(),l("span",E,[t("span",A,a(s.sortDirection==="asc"?"arrow_drop_up":"arrow_drop_down"),1)])):d("",!0)]),t("th",{onClick:e[8]||(e[8]=r=>n.sortBy("price")),class:"sortable"},[c(" Price"),s.sortByField==="price"?(i(),l("span",M,[t("span",U,a(s.sortDirection==="asc"?"arrow_drop_up":"arrow_drop_down"),1)])):d("",!0)]),t("th",{onClick:e[9]||(e[9]=r=>n.sortBy("user")),class:"sortable"},[c(" User"),s.sortByField==="user"?(i(),l("span",z,[t("span",G,a(s.sortDirection==="asc"?"arrow_drop_up":"arrow_drop_down"),1)])):d("",!0)]),X])]),t("tbody",null,[(i(!0),l(w,null,C(n.sortedData,r=>(i(),l("tr",{key:r.PO},[t("td",null,a(r.PO),1),t("td",null,a(r.Pdate),1),t("td",null,a(r.item_list),1),t("td",null,a(r.description),1),t("td",null,a(r.category),1),t("td",null,a(r.qty),1),t("td",null,a(r.price),1),t("td",null,a(r.user),1),H]))),128))])]),B(p,{"current-page":s.currentPage,"total-page-count":s.totalPageCount,"per-page":s.limit,totalRecords:s.totalRecords,onPageChange:n.handlePageChange,onPerPageChange:n.handlePerPageChange},null,8,["current-page","total-page-count","per-page","totalRecords","onPageChange","onPerPageChange"])])}const K=_(v,[["render",J],["__scopeId","data-v-9b7bb8b6"]]),W={components:{TableComp:K}};function Y(o,e,h,u,s,n){const p=y("TableComp");return i(),F(p)}const tt=_(W,[["render",Y]]);export{tt as default};
